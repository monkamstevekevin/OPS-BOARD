{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let ApiService = /*#__PURE__*/(() => {\n  class ApiService {\n    constructor(http) {\n      this.http = http;\n    }\n    base() {\n      const cfg = (localStorage.getItem('ops.baseUrl') || '').trim();\n      if (cfg) return cfg; // user-configured absolute base URL\n      // Dev: if running via Angular dev server (port 4200), use proxy with relative /api\n      if (location.port === '4200') return '';\n      // Fallback default\n      return 'http://localhost:8060';\n    }\n    listAssets(q = '') {\n      const url = `${this.base()}/api/assets${q ? `?q=${encodeURIComponent(q)}` : ''}`;\n      return this.http.get(url);\n    }\n    getAsset(hostname) {\n      return this.http.get(`${this.base()}/api/assets/${encodeURIComponent(hostname)}`);\n    }\n    latestMetrics(hostname, limit) {\n      return this.http.get(`${this.base()}/api/assets/${encodeURIComponent(hostname)}/metrics?limit=${limit}`);\n    }\n    rangeMetrics(hostname, fromIso, toIso) {\n      return this.http.get(`${this.base()}/api/assets/${encodeURIComponent(hostname)}/metrics?from=${encodeURIComponent(fromIso)}&to=${encodeURIComponent(toIso)}`);\n    }\n    summary(hostname, fromIso, toIso) {\n      return this.http.get(`${this.base()}/api/assets/${encodeURIComponent(hostname)}/metrics/summary?from=${encodeURIComponent(fromIso)}&to=${encodeURIComponent(toIso)}`);\n    }\n    patchAsset(hostname, body) {\n      return this.http.patch(`${this.base()}/api/assets/${encodeURIComponent(hostname)}`, body);\n    }\n    // Live status\n    liveAll() {\n      return this.http.get(`${this.base()}/api/status/live`);\n    }\n    liveOne(hostname) {\n      return this.http.get(`${this.base()}/api/status/live/${encodeURIComponent(hostname)}`);\n    }\n    // Alerts\n    listAlerts(params) {\n      const qs = [];\n      if (params) {\n        if (params.host) qs.push(`host=${encodeURIComponent(params.host)}`);\n        if (typeof params.ack === 'boolean') qs.push(`ack=${params.ack}`);\n        if (params.limit) qs.push(`limit=${params.limit}`);\n        if (params.offset) qs.push(`offset=${params.offset}`);\n      }\n      const q = qs.length ? `?${qs.join('&')}` : '';\n      return this.http.get(`${this.base()}/api/alerts${q}`);\n    }\n    ackAlert(id) {\n      return this.http.post(`${this.base()}/api/alerts/${encodeURIComponent(id)}/ack`, {});\n    }\n    // Admin discovery\n    discoveryPreview() {\n      return this.http.get(`${this.base()}/api/admin/discovery/preview`);\n    }\n    discoveryApply(proposals) {\n      return this.http.post(`${this.base()}/api/admin/discovery/apply`, {\n        proposals\n      });\n    }\n    // Admin alerts config\n    getAlertsConfig() {\n      return this.http.get(`${this.base()}/api/admin/alerts/config`);\n    }\n    updateAlertsConfig(cfg) {\n      return this.http.put(`${this.base()}/api/admin/alerts/config`, cfg);\n    }\n    // Admin asset mapping\n    adminUpdateMapping(hostname, node, vmid) {\n      return this.http.patch(`${this.base()}/api/admin/assets/${encodeURIComponent(hostname)}/mapping`, {\n        node,\n        vmid\n      });\n    }\n    // Admin endpoints\n    adminStart(node, vmid) {\n      return this.http.post(`${this.base()}/api/admin/vm/${encodeURIComponent(node)}/${vmid}/start`, {});\n    }\n    adminShutdown(node, vmid) {\n      return this.http.post(`${this.base()}/api/admin/vm/${encodeURIComponent(node)}/${vmid}/shutdown`, {});\n    }\n    adminStop(node, vmid) {\n      return this.http.post(`${this.base()}/api/admin/vm/${encodeURIComponent(node)}/${vmid}/stop`, {});\n    }\n    adminReset(node, vmid) {\n      return this.http.post(`${this.base()}/api/admin/vm/${encodeURIComponent(node)}/${vmid}/reset`, {});\n    }\n    adminExec(node, vmid, command, input, timeoutSec) {\n      return this.http.post(`${this.base()}/api/admin/exec/${encodeURIComponent(node)}/${vmid}`, {\n        command,\n        input,\n        timeoutSec\n      });\n    }\n    // Bulk actions\n    adminBulk(action, payload) {\n      return this.http.post(`${this.base()}/api/admin/vm/bulk/${action}`, payload);\n    }\n    static {\n      this.ɵfac = function ApiService_Factory(t) {\n        return new (t || ApiService)(i0.ɵɵinject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: ApiService,\n        factory: ApiService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return ApiService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}