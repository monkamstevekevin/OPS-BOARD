{"ast":null,"code":"import { signal } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterLink } from '@angular/router';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../services/api.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nconst _c0 = [\"cpuCanvas\"];\nconst _c1 = [\"ramCanvas\"];\nconst _c2 = [\"dskCanvas\"];\nconst _c3 = () => [];\nfunction AssetDetailComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵtext(1, \"Chargement...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AssetDetailComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"Erreur: \", ctx_r0.error(), \"\");\n  }\n}\nfunction AssetDetailComponent_div_4_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"div\", 11)(2, \"label\");\n    i0.ɵɵtext(3, \"VM \");\n    i0.ɵɵelementStart(4, \"span\", 17);\n    i0.ɵɵtext(5, \"i\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\")(7, \"span\", 18);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"span\", 18);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(11, \"div\", 11)(12, \"label\");\n    i0.ɵɵtext(13, \"IP (Live)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"div\");\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"div\", 11)(17, \"label\");\n    i0.ɵɵtext(18, \"Node/VMID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"div\");\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(21, \"div\", 11)(22, \"label\");\n    i0.ɵɵtext(23, \"Refresh\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"div\");\n    i0.ɵɵtext(25);\n    i0.ɵɵpipe(26, \"date\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const lv_r3 = ctx.ngIf;\n    i0.ɵɵadvance(7);\n    i0.ɵɵclassProp(\"up\", (lv_r3 == null ? null : lv_r3.vmState) === \"running\")(\"down\", (lv_r3 == null ? null : lv_r3.vmState) !== \"running\");\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate((lv_r3 == null ? null : lv_r3.vmState) || \"-\");\n    i0.ɵɵadvance();\n    i0.ɵɵclassProp(\"up\", lv_r3 == null ? null : lv_r3.qgaUp)(\"down\", lv_r3 && !(lv_r3 == null ? null : lv_r3.qgaUp));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"GA: \", (lv_r3 == null ? null : lv_r3.qgaUp) ? \"UP\" : \"DOWN\", \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate((lv_r3 == null ? null : lv_r3.ipv4) || \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate2(\"\", (lv_r3 == null ? null : lv_r3.node) || \"-\", \" / \", (lv_r3 == null ? null : lv_r3.vmid) || \"-\", \"\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(26, 14, lv_r3 == null ? null : lv_r3.fetchedAt, \"mediumTime\"));\n  }\n}\nfunction AssetDetailComponent_div_4_div_26_span_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"number\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"\\u00B7 MEM \", i0.ɵɵpipeBind2(2, 1, ctx_r0.live.topMem, \"1.0-1\"), \"%\");\n  }\n}\nfunction AssetDetailComponent_div_4_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"div\", 11)(2, \"label\");\n    i0.ɵɵtext(3, \"Top Process\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\");\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"number\");\n    i0.ɵɵtemplate(7, AssetDetailComponent_div_4_div_26_span_7_Template, 3, 4, \"span\", 19);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate3(\"PID \", ctx_r0.live.topPid, \" \\u00B7 \", ctx_r0.live.topName, \" \\u00B7 CPU \", i0.ɵɵpipeBind2(6, 4, ctx_r0.live.topCpu, \"1.0-0\"), \"% \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.live.topMem);\n  }\n}\nfunction AssetDetailComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"h3\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 10)(4, \"div\", 11)(5, \"label\");\n    i0.ɵɵtext(6, \"IP\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 11)(10, \"label\");\n    i0.ɵɵtext(11, \"OS\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"div\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"div\", 11)(15, \"label\");\n    i0.ɵɵtext(16, \"Owner\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\");\n    i0.ɵɵtext(18);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(19, \"div\", 11)(20, \"label\");\n    i0.ɵɵtext(21, \"Last Seen\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"div\");\n    i0.ɵɵtext(23);\n    i0.ɵɵpipe(24, \"date\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(25, AssetDetailComponent_div_4_div_25_Template, 27, 17, \"div\", 9)(26, AssetDetailComponent_div_4_div_26_Template, 8, 7, \"div\", 9);\n    i0.ɵɵelementStart(27, \"div\", 10)(28, \"div\", 11)(29, \"label\");\n    i0.ɵɵtext(30, \"Tags\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(31, \"div\");\n    i0.ɵɵtext(32);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelement(33, \"hr\");\n    i0.ɵɵelementStart(34, \"h3\");\n    i0.ɵɵtext(35, \"\\u00C3\\u2030diter\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(36, \"div\", 10)(37, \"div\", 11)(38, \"label\");\n    i0.ɵɵtext(39, \"Nouveau Owner\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(40, \"input\", 12);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AssetDetailComponent_div_4_Template_input_ngModelChange_40_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r0.editOwner, $event) || (ctx_r0.editOwner = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(41, \"div\", 11)(42, \"label\");\n    i0.ɵɵtext(43, \"Tags (s\\u00C3\\u00A9par\\u00C3\\u00A9s par des virgules)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(44, \"input\", 13);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AssetDetailComponent_div_4_Template_input_ngModelChange_44_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r0.editTags, $event) || (ctx_r0.editTags = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(45, \"div\", 14)(46, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function AssetDetailComponent_div_4_Template_button_click_46_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.saveMeta());\n    });\n    i0.ɵɵtext(47, \"Enregistrer\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(48, \"hr\");\n    i0.ɵɵelementStart(49, \"h3\");\n    i0.ɵɵtext(50, \"Admin \\u00B7 Node/VMID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(51, \"div\", 10)(52, \"div\", 11)(53, \"label\");\n    i0.ɵɵtext(54, \"Node\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(55, \"input\", 15);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AssetDetailComponent_div_4_Template_input_ngModelChange_55_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r0.editNode, $event) || (ctx_r0.editNode = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(56, \"div\", 11)(57, \"label\");\n    i0.ɵɵtext(58, \"VMID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(59, \"input\", 16);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AssetDetailComponent_div_4_Template_input_ngModelChange_59_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r0.editVmid, $event) || (ctx_r0.editVmid = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(60, \"div\", 14)(61, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function AssetDetailComponent_div_4_Template_button_click_61_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.saveMapping());\n    });\n    i0.ɵɵtext(62, \"Save Mapping\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const a_r4 = ctx.ngIf;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(a_r4.hostname);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(a_r4.ip);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(a_r4.os);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(a_r4.owner);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(a_r4.lastSeen ? i0.ɵɵpipeBind2(24, 12, a_r4.lastSeen, \"short\") : \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.live);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.live && ctx_r0.live.topPid);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate((a_r4.tags || i0.ɵɵpureFunction0(15, _c3)).join(\", \"));\n    i0.ɵɵadvance(8);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r0.editOwner);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r0.editTags);\n    i0.ɵɵadvance(11);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r0.editNode);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r0.editVmid);\n  }\n}\nfunction AssetDetailComponent_div_5_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"div\", 11)(2, \"label\");\n    i0.ɵɵtext(3, \"CPU\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\");\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"number\");\n    i0.ɵɵpipe(7, \"number\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"div\", 11)(9, \"label\");\n    i0.ɵɵtext(10, \"RAM\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"div\");\n    i0.ɵɵtext(12);\n    i0.ɵɵpipe(13, \"number\");\n    i0.ɵɵpipe(14, \"number\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"div\", 11)(16, \"label\");\n    i0.ɵɵtext(17, \"Disk\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"div\");\n    i0.ɵɵtext(19);\n    i0.ɵɵpipe(20, \"number\");\n    i0.ɵɵpipe(21, \"number\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind2(6, 6, ctx_r0.summary == null ? null : ctx_r0.summary.cpuAvg, \"1.0-0\"), \"% avg / \", i0.ɵɵpipeBind2(7, 9, ctx_r0.summary == null ? null : ctx_r0.summary.cpuMax, \"1.0-0\"), \"% max\");\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind2(13, 12, ctx_r0.summary == null ? null : ctx_r0.summary.ramAvg, \"1.0-0\"), \"% avg / \", i0.ɵɵpipeBind2(14, 15, ctx_r0.summary == null ? null : ctx_r0.summary.ramMax, \"1.0-0\"), \"% max\");\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind2(20, 18, ctx_r0.summary == null ? null : ctx_r0.summary.diskAvg, \"1.0-0\"), \"% avg / \", i0.ɵɵpipeBind2(21, 21, ctx_r0.summary == null ? null : ctx_r0.summary.diskMax, \"1.0-0\"), \"% max\");\n  }\n}\nfunction AssetDetailComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"h3\");\n    i0.ɵɵtext(2, \"Metrics (latest) \");\n    i0.ɵɵelementStart(3, \"span\", 20);\n    i0.ɵɵtext(4, \"i\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 10)(6, \"div\", 11)(7, \"label\");\n    i0.ɵɵtext(8, \"P\\u00C3\\u00A9riode\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 10)(10, \"div\", 11)(11, \"input\", 21);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AssetDetailComponent_div_5_Template_input_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r0 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r0.fromLocal, $event) || (ctx_r0.fromLocal = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"div\", 11)(13, \"input\", 21);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function AssetDetailComponent_div_5_Template_input_ngModelChange_13_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r0 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r0.toLocal, $event) || (ctx_r0.toLocal = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"div\", 11)(15, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function AssetDetailComponent_div_5_Template_button_click_15_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.loadRange());\n    });\n    i0.ɵɵtext(16, \"Charger\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(17, AssetDetailComponent_div_5_div_17_Template, 22, 24, \"div\", 9);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(18, \"div\", 10)(19, \"div\", 11)(20, \"label\");\n    i0.ɵɵtext(21, \"CPU %\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(22, \"canvas\", 22, 0);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"div\", 11)(25, \"label\");\n    i0.ɵɵtext(26, \"RAM %\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(27, \"canvas\", 22, 1);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(29, \"div\", 11)(30, \"label\");\n    i0.ɵɵtext(31, \"Disk %\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(32, \"canvas\", 22, 2);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(11);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r0.fromLocal);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r0.toLocal);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.summary);\n  }\n}\nfunction AssetDetailComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 23);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r0.diagError);\n  }\n}\nfunction AssetDetailComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 23);\n    i0.ɵɵtext(1, \"Not a Proxmox VM (no node/vmid mapping)\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AssetDetailComponent_div_14_table_4_tr_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const p_r6 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r6.pid);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r6.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(7, 4, p_r6.cpu, \"1.0-1\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(p_r6.mem || p_r6.WorkingSet);\n  }\n}\nfunction AssetDetailComponent_div_14_table_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 25)(1, \"thead\")(2, \"tr\")(3, \"th\");\n    i0.ɵɵtext(4, \"PID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"CPU %\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"MEM % / WS\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(11, \"tbody\");\n    i0.ɵɵtemplate(12, AssetDetailComponent_div_14_table_4_tr_12_Template, 10, 7, \"tr\", 26);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.diag.cpuTop);\n  }\n}\nfunction AssetDetailComponent_div_14_table_8_tr_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const p_r7 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r7.pid);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r7.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(7, 4, p_r7.cpu, \"1.0-1\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(p_r7.mem || p_r7.WorkingSet);\n  }\n}\nfunction AssetDetailComponent_div_14_table_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 25)(1, \"thead\")(2, \"tr\")(3, \"th\");\n    i0.ɵɵtext(4, \"PID\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"CPU %\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"MEM % / WS\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(11, \"tbody\");\n    i0.ɵɵtemplate(12, AssetDetailComponent_div_14_table_8_tr_12_Template, 10, 7, \"tr\", 26);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.diag.memTop);\n  }\n}\nfunction AssetDetailComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"div\", 11)(2, \"label\");\n    i0.ɵɵtext(3, \"Top CPU\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, AssetDetailComponent_div_14_table_4_Template, 13, 1, \"table\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 11)(6, \"label\");\n    i0.ɵɵtext(7, \"Top RAM\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(8, AssetDetailComponent_div_14_table_8_Template, 13, 1, \"table\", 24);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.diag.cpuTop == null ? null : ctx_r0.diag.cpuTop.length);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.diag.memTop == null ? null : ctx_r0.diag.memTop.length);\n  }\n}\nexport let AssetDetailComponent = /*#__PURE__*/(() => {\n  class AssetDetailComponent {\n    constructor(route, api) {\n      this.route = route;\n      this.api = api;\n      this.hostname = '';\n      this.asset = signal(null);\n      this.metrics = signal([]);\n      this.loading = signal(true);\n      this.error = signal(null);\n      this.live = null;\n      this.editOwner = '';\n      this.editTags = '';\n      this.editNode = '';\n      this.editVmid = '';\n      this.fromLocal = '';\n      this.toLocal = '';\n      this.summary = null;\n      this.alertsAll = [];\n      this.diag = null;\n      this.diagError = null;\n      this.hostname = this.route.snapshot.paramMap.get('hostname') || '';\n      this.fetch();\n      this.pullLive();\n      this.liveTimer = setInterval(() => this.pullLive(), 30000);\n      this.metricsTimer = setInterval(() => this.refreshLatestMetrics(), 30000);\n      this.pullAlerts();\n      this.alertsTimer = setInterval(() => this.pullAlerts(), 15000);\n    }\n    fetch() {\n      this.loading.set(true);\n      this.error.set(null);\n      this.api.getAsset(this.hostname).subscribe({\n        next: a => {\n          this.asset.set(a);\n          this.editOwner = a.owner || '';\n          this.editTags = (a.tags || []).join(', ');\n        },\n        error: e => {\n          this.error.set(e.message || 'error');\n          this.loading.set(false);\n        }\n      });\n      this.api.latestMetrics(this.hostname, 50).subscribe({\n        next: m => {\n          this.metrics.set(m);\n          this.loading.set(false);\n          setTimeout(() => this.drawCharts(), 0);\n        },\n        error: e => {\n          this.error.set(e.message || 'error');\n          this.loading.set(false);\n        }\n      });\n    }\n    drawCharts() {\n      const cpu = this.cpuRef?.nativeElement;\n      const ram = this.ramRef?.nativeElement;\n      const dsk = this.dskRef?.nativeElement;\n      const points = this.metrics();\n      if (!cpu || !ram || !dsk || !points.length) return;\n      const draw = (canvas, series, color) => {\n        const ctx = canvas.getContext('2d');\n        const w = canvas.width = canvas.clientWidth * devicePixelRatio;\n        const h = canvas.height = canvas.clientHeight * devicePixelRatio;\n        ctx.scale(devicePixelRatio, devicePixelRatio);\n        const pad = 30;\n        const innerW = canvas.clientWidth - pad * 2;\n        const innerH = canvas.clientHeight - pad * 2;\n        const minY = 0,\n          maxY = 100;\n        const spanY = 100;\n        const xCount = series.length;\n        const xTo = i => pad + i / Math.max(1, xCount - 1) * innerW;\n        const yTo = v => pad + innerH - (v - minY) / spanY * innerH;\n        ctx.fillStyle = '#0f172a';\n        ctx.fillRect(0, 0, canvas.clientWidth, canvas.clientHeight);\n        ctx.strokeStyle = '#223152';\n        ctx.beginPath();\n        ctx.moveTo(pad, pad);\n        ctx.lineTo(pad, pad + innerH);\n        ctx.lineTo(pad + innerW, pad + innerH);\n        ctx.stroke();\n        ctx.strokeStyle = color;\n        ctx.lineWidth = 2;\n        ctx.beginPath();\n        series.forEach((v, i) => {\n          const x = xTo(i),\n            y = yTo(v);\n          if (i === 0) ctx.moveTo(x, y);else ctx.lineTo(x, y);\n        });\n        ctx.stroke();\n        ctx.fillStyle = '#94a3b8';\n        ctx.font = '12px system-ui';\n        ctx.fillText('0', 4, pad + innerH);\n        ctx.fillText('100', 4, pad + 12);\n      };\n      draw(cpu, points.map(p => p.cpu), '#f59e0b');\n      draw(ram, points.map(p => p.ram), '#22c55e');\n      draw(dsk, points.map(p => p.disk), '#0ea5e9');\n    }\n    refreshLatestMetrics() {\n      // If user selected a custom range, do not override\n      if (this.fromLocal || this.toLocal) return;\n      this.api.latestMetrics(this.hostname, 50).subscribe({\n        next: m => {\n          this.metrics.set(m);\n          setTimeout(() => this.drawCharts(), 0);\n        },\n        error: _ => {}\n      });\n    }\n    saveMeta() {\n      const tags = this.editTags.split(',').map(s => s.trim()).filter(Boolean);\n      this.api.patchAsset(this.hostname, {\n        owner: this.editOwner || null,\n        tags\n      }).subscribe({\n        next: () => this.fetch(),\n        error: e => this.error.set(e.message || 'error')\n      });\n    }\n    saveMapping() {\n      if (!this.editNode || !this.editVmid) return;\n      this.api.adminUpdateMapping(this.hostname, this.editNode, Number(this.editVmid)).subscribe({\n        next: _ => this.pullLive(),\n        error: e => this.error.set(e.message || 'error')\n      });\n    }\n    loadRange() {\n      if (!this.fromLocal || !this.toLocal) return;\n      const fromIso = new Date(this.fromLocal).toISOString();\n      const toIso = new Date(this.toLocal).toISOString();\n      this.loading.set(true);\n      this.api.rangeMetrics(this.hostname, fromIso, toIso).subscribe({\n        next: pts => {\n          this.metrics.set(pts);\n          this.loading.set(false);\n          setTimeout(() => this.drawCharts(), 0);\n        },\n        error: e => {\n          this.error.set(e.message || 'error');\n          this.loading.set(false);\n        }\n      });\n      this.api.summary(this.hostname, fromIso, toIso).subscribe({\n        next: s => this.summary = s,\n        error: _ => {}\n      });\n    }\n    // Alerts for this host\n    hostAlerts() {\n      return this.alertsAll.filter(a => a.hostname === this.hostname && !a.acknowledged);\n    }\n    pullAlerts() {\n      this.api.listAlerts().subscribe({\n        next: l => this.alertsAll = l,\n        error: _ => {}\n      });\n    }\n    ackAlert(id) {\n      this.api.ackAlert(id).subscribe({\n        next: _ => this.pullAlerts(),\n        error: _ => {}\n      });\n    }\n    diagnose() {\n      this.diagError = null;\n      this.diag = null;\n      this.api.adminDiagnose(this.hostname, 3).subscribe({\n        next: r => {\n          this.diag = r;\n          this.diagError = r && r.error ? r.error : null;\n        },\n        error: e => {\n          this.diagError = e.message || 'error';\n        }\n      });\n    }\n    pullLive() {\n      this.api.liveOne(this.hostname).subscribe({\n        next: s => this.live = s,\n        error: _ => {}\n      });\n    }\n    ngOnDestroy() {\n      if (this.liveTimer) clearInterval(this.liveTimer);\n      if (this.metricsTimer) clearInterval(this.metricsTimer);\n      if (this.alertsTimer) clearInterval(this.alertsTimer);\n    }\n    static {\n      this.ɵfac = function AssetDetailComponent_Factory(t) {\n        return new (t || AssetDetailComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.ApiService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: AssetDetailComponent,\n        selectors: [[\"app-asset-detail\"]],\n        viewQuery: function AssetDetailComponent_Query(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵviewQuery(_c0, 5);\n            i0.ɵɵviewQuery(_c1, 5);\n            i0.ɵɵviewQuery(_c2, 5);\n          }\n          if (rf & 2) {\n            let _t;\n            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.cpuRef = _t.first);\n            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.ramRef = _t.first);\n            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.dskRef = _t.first);\n          }\n        },\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 15,\n        vars: 7,\n        consts: [[\"cpuCanvas\", \"\"], [\"ramCanvas\", \"\"], [\"dskCanvas\", \"\"], [\"routerLink\", \"/assets\"], [\"class\", \"card\", 4, \"ngIf\"], [1, \"card\"], [1, \"actions\", 2, \"margin-bottom\", \"8px\"], [1, \"btn\", 3, \"click\"], [\"class\", \"muted\", 4, \"ngIf\"], [\"class\", \"row\", 4, \"ngIf\"], [1, \"row\"], [1, \"col\"], [\"placeholder\", \"owner\", 3, \"ngModelChange\", \"ngModel\"], [\"placeholder\", \"tag1, tag2\", 3, \"ngModelChange\", \"ngModel\"], [1, \"actions\", 2, \"margin-top\", \"8px\"], [\"placeholder\", \"pve01\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"number\", \"placeholder\", \"123\", 3, \"ngModelChange\", \"ngModel\"], [\"data-tip\", \"Status = power only (running=UP, stopped=DOWN)\\nGA = QEMU Guest Agent reachability.\", 1, \"help\"], [1, \"status\"], [4, \"ngIf\"], [\"data-tip\", \"CPU = used % of total VM capacity (all vCPUs)\\nRAM/Disk = used %\", 1, \"help\"], [\"type\", \"datetime-local\", 3, \"ngModelChange\", \"ngModel\"], [1, \"chart\"], [1, \"muted\"], [\"class\", \"assets-table\", 4, \"ngIf\"], [1, \"assets-table\"], [4, \"ngFor\", \"ngForOf\"]],\n        template: function AssetDetailComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"a\", 3);\n            i0.ɵɵtext(1, \"\\u00E2\\u2020\\u0090 retour\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(2, AssetDetailComponent_div_2_Template, 2, 0, \"div\", 4)(3, AssetDetailComponent_div_3_Template, 2, 1, \"div\", 4)(4, AssetDetailComponent_div_4_Template, 63, 16, \"div\", 4)(5, AssetDetailComponent_div_5_Template, 34, 3, \"div\", 4);\n            i0.ɵɵelementStart(6, \"div\", 5)(7, \"h3\");\n            i0.ɵɵtext(8, \"Diagnostics\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(9, \"div\", 6)(10, \"button\", 7);\n            i0.ɵɵlistener(\"click\", function AssetDetailComponent_Template_button_click_10_listener() {\n              return ctx.diagnose();\n            });\n            i0.ɵɵtext(11, \"Diagnose Now\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(12, AssetDetailComponent_div_12_Template, 2, 1, \"div\", 8)(13, AssetDetailComponent_div_13_Template, 2, 0, \"div\", 8)(14, AssetDetailComponent_div_14_Template, 9, 2, \"div\", 9);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngIf\", ctx.loading());\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.error());\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.asset());\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.metrics().length);\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"ngIf\", ctx.diagError);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.diag == null ? null : ctx.diag.notVm);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.diag);\n          }\n        },\n        dependencies: [CommonModule, i3.NgForOf, i3.NgIf, i3.DecimalPipe, i3.DatePipe, RouterLink, FormsModule, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.NgControlStatus, i4.NgModel],\n        encapsulation: 2\n      });\n    }\n  }\n  return AssetDetailComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}