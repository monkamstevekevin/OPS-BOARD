{"ast":null,"code":"import { signal } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/api.service\";\nimport * as i2 from \"@angular/common\";\nfunction AlertsComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 3);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"Erreur: \", ctx_r0.error(), \"\");\n  }\n}\nfunction AlertsComponent_table_4_tr_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\")(11, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function AlertsComponent_table_4_tr_14_Template_button_click_11_listener() {\n      const a_r3 = i0.ɵɵrestoreView(_r2).$implicit;\n      const ctx_r0 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r0.ack(a_r3.id));\n    });\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const a_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(3, 6, a_r3.ts, \"short\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(a_r3.hostname);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(a_r3.type);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(a_r3.message);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", a_r3.acknowledged);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(a_r3.acknowledged ? \"Acked\" : \"Ack\");\n  }\n}\nfunction AlertsComponent_table_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 4)(1, \"thead\")(2, \"tr\")(3, \"th\");\n    i0.ɵɵtext(4, \"Time\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"Host\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Message\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"Ack\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(13, \"tbody\");\n    i0.ɵɵtemplate(14, AlertsComponent_table_4_tr_14_Template, 13, 9, \"tr\", 5);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(14);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.alerts());\n  }\n}\nfunction AlertsComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 3);\n    i0.ɵɵtext(1, \"No alerts\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let AlertsComponent = /*#__PURE__*/(() => {\n  class AlertsComponent {\n    constructor(api) {\n      this.api = api;\n      this.alerts = signal([]);\n      this.error = signal(null);\n      this.load();\n      this.timer = setInterval(() => this.load(), 15000);\n    }\n    load() {\n      this.api.listAlerts().subscribe({\n        next: l => {\n          this.alerts.set(l);\n          this.error.set(null);\n        },\n        error: e => this.error.set(e.message || 'error')\n      });\n    }\n    ack(id) {\n      this.api.ackAlert(id).subscribe({\n        next: _ => this.load(),\n        error: e => this.error.set(e.message || 'error')\n      });\n    }\n    ngOnDestroy() {\n      if (this.timer) clearInterval(this.timer);\n    }\n    static {\n      this.ɵfac = function AlertsComponent_Factory(t) {\n        return new (t || AlertsComponent)(i0.ɵɵdirectiveInject(i1.ApiService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: AlertsComponent,\n        selectors: [[\"app-alerts\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 6,\n        vars: 3,\n        consts: [[1, \"card\"], [\"class\", \"muted\", 4, \"ngIf\"], [\"class\", \"assets-table\", 4, \"ngIf\"], [1, \"muted\"], [1, \"assets-table\"], [4, \"ngFor\", \"ngForOf\"], [1, \"btn\", 3, \"click\", \"disabled\"]],\n        template: function AlertsComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h3\");\n            i0.ɵɵtext(2, \"Alerts\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(3, AlertsComponent_div_3_Template, 2, 1, \"div\", 1)(4, AlertsComponent_table_4_Template, 15, 1, \"table\", 2)(5, AlertsComponent_div_5_Template, 2, 0, \"div\", 1);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngIf\", ctx.error());\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.alerts().length);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.alerts().length && !ctx.error());\n          }\n        },\n        dependencies: [CommonModule, i2.NgForOf, i2.NgIf, i2.DatePipe],\n        encapsulation: 2\n      });\n    }\n  }\n  return AlertsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}